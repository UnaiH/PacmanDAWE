//  variable global temporalmente para poder testear el ejercicio
inputStates = {
  	left: false,
    	right: false,
    	up: false,
    	down: false,
    	space: false,
};

Pacman.prototype.move = function() {

	// test4
	// Tu código aquí
    
    	if (inputStates.left && this.x-this.speed>=0) {
    		this.x = this.x-this.speed;
    	}
    	else if (inputStates.right && this.x+this.speed<=w-this.radius*2) {
    		this.x = this.x+this.speed;
    	}
	else if (inputStates.up && this.y-this.speed>=0) {
    		this.y = this.y-this.speed;
    	}
    	else if (inputStates.down && this.y+this.speed<=h-this.radius*2) {
    		this.y = this.y+this.speed;
    	}
      
};

// Función para pintar el Pacman
Pacman.prototype.draw = function(x, y) {
         
	// Pac Man
	// test2   
	// Tu código aquí
	// ojo: en el test2 esta función se llama drawPacman(x,y))	 
    
    	ctx.beginPath();
	ctx.arc(this.x+this.radius, this.y+this.radius, this.radius, this.angle1*Math.PI, this.angle2*Math.PI);
	ctx.lineTo(this.x+this.radius, this.y+this.radius);
    	ctx.closePath();
    	ctx.strokeStyle = "black";
    	ctx.stroke();
    	ctx.fillStyle = "yellow";
    	ctx.fill();
    
}

var checkInputs = function(){
	// test4
	// Tu código aquí   
};

var addListeners = function(){
	// add the listener to the main, window object, and update the states
	// test4
	// Tu código aquí
    
    	function habilitarGestor() {
      		window.addEventListener('keydown', keyDown, false);
      		window.addEventListener('keydown', disableScroll, false);
      		window.addEventListener('keyup', keyUp, false);
      		window.addEventListener('keyup', disableScroll, false);
    	}

    	function deshabilitarGestor() {
      		window.removeEventListener('keydown', keyDown, false);
      		window.removeEventListener('keydown', disableScroll, false);
      		window.removeEventListener('keyup', keyUp, false);
      		window.removeEventListener('keyup', disableScroll, false);
   	}

    	window.onload = habilitarGestor;
    	window.onblur = deshabilitarGestor;
    	window.onfocus = habilitarGestor;

    	function keyDown(e) {
      		const keyName = e.key;
      		if (keyName === 'ArrowLeft') {
        		inputStates.left = true;
      		} else if (keyName === 'ArrowRight') {
        		inputStates.right = true;
      		} else if (keyName === 'ArrowUp') {
        		inputStates.up = true;
      		} else if (keyName === 'ArrowDown') {
        		inputStates.down = true;
      		} else if (keyName === ' ') {
        		console.log(`Space pressed`);
      		}
    	}

    	function keyUp(e) {
      		const keyName = e.key;
      		if (keyName === 'ArrowLeft') {
       	 		inputStates.left = false;
      		} else if (keyName === 'ArrowRight') {
        		inputStates.right = false;
      		} else if (keyName === 'ArrowUp') {
        		inputStates.up = false;
      		} else if (keyName === 'ArrowDown') {
        		inputStates.down = false;
      		}
    	}

    	function disableScroll(e) {
      		if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight", " "].indexOf(e.code) > -1) {
        		event.preventDefault();
      		}
    	}
    
};